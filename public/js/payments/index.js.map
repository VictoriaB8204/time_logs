{"version":3,"file":"/js/payments/index.js","mappings":"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","sources":["webpack:///./resources/js/handle_errors.js","webpack:///./resources/js/payments/index/generate_bill.js","webpack:///./resources/js/payments/index/get_excel.js","webpack:///./resources/js/time_logs/index/onload.js","webpack:///./resources/js/resize_textarea.js","webpack:///./resources/js/payments/index/payed.js","webpack:///./resources/js/refresh_block.js","webpack:///./resources/js/time_logs/index/localStorage.js","webpack:///./resources/js/toasts.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./resources/js/payments/index.js"],"sourcesContent":["import {showFailToast} from \"./toasts\";\n\nexport function handleError(error, infoMessage) {\n    console.log(error);\n    showFailToast(infoMessage + ' Ошибка ' + error.status + ' ' + error.statusText);\n}\n","$(document).on('click', '#generate_invoice', function () {\n    console.log($('#billGenerationForm').serialize());\n    $.ajax({\n        url: '/payments/generate_invoice',\n        method: 'post',\n        data: $('#billGenerationForm').serialize(),\n        success: function(response) {\n            downloadFile(response)\n        },\n        error: function(xhr) {\n            alert('Ошибка: ' + xhr.responseText);\n        }\n    })\n})\n\n$(document).on('click', '#generate_act', function () {\n    console.log($('#billGenerationForm').serialize());\n    $.ajax({\n        url: '/payments/generate_act',\n        method: 'post',\n        data: $('#billGenerationForm').serialize(),\n        success: function(response) {\n            downloadFile(response)\n        },\n        error: function(xhr) {\n            alert('Ошибка: ' + xhr.responseText);\n        }\n    })\n})\n\nfunction downloadFile(response){\n    if (response.file) {\n        // Вариант 1: Скачивание через base64\n        const byteCharacters = atob(response.file);\n        const byteNumbers = new Array(byteCharacters.length);\n        for (let i = 0; i < byteCharacters.length; i++) {\n            byteNumbers[i] = byteCharacters.charCodeAt(i);\n        }\n        const byteArray = new Uint8Array(byteNumbers);\n        const blob = new Blob([byteArray], {type: response.mime});\n\n        const link = document.createElement('a');\n        link.href = window.URL.createObjectURL(blob);\n        link.download = response.filename;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n    } else if (response.url) {\n        // Вариант 2: Скачивание по ссылке\n        window.location.href = response.url;\n    }\n}\n","import {handleError} from \"../../handle_errors\";\n\n$(document).on('click', '#get_payment_excel_button', function () {\n    $.ajax({\n        url: '/payments/get_excel',\n        method: 'get',\n        error: function(error){\n            handleError(error, 'Export to Excel failed');\n        },\n        success: function (path) {\n            let link = document.createElement('a');\n            link.setAttribute('href', path);\n            link.setAttribute('download', '');\n            link.click();\n        }\n    })\n})\n","import {resizeTextArea} from \"../../resize_textarea\";\nimport {showValue} from \"./localStorage\";\n\nexport function documentOnLoad() {\n    resizeTextArea();\n\n    $('#create_form input, #create_form textarea').each(function () {\n        showValue($(this));\n    })\n\n    if($('#start_time_date').val() && !$('#end_time_date').val()){\n        $('#start_time_log').attr('hidden', true);\n        $('#end_time_log').removeAttr('hidden');\n    }\n}\n","export function resizeTextArea(){\n    $('textarea').each(function(){\n        $(this).outerHeight(38).outerHeight(this.scrollHeight);\n    })\n}\n","import {handleError} from \"../../handle_errors\";\nimport {showSuccessToast} from \"../../toasts\";\nimport {refresh} from \"../../refresh_block\";\n\n$(document).on('click', '.payed_button', function () {\n    if(confirm('Do you really want to pay for this time?')){\n        $.ajax({\n            url: 'payments/pay_for_the_time/' + $(this).closest('tr').find('.user_id').val(),\n            method: 'post',\n            headers: {\n                'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n            },\n            error: function(error){\n                handleError(error, 'Paying failed');\n            },\n            success: function (result) {\n                refresh($('#users_table'), $(result));\n                showSuccessToast('The time was successfully payed');\n            }\n        })\n    }\n})\n","import {documentOnLoad} from \"./time_logs/index/onload\";\n\n\nexport function refresh(block, replace){\n    let ret = block.replaceWith(replace); // Call replaceWith\n\n    documentOnLoad();\n\n    return ret;  // For chaining\n}\n","export function remember(input){\n    let name = input.attr('name');\n    let val = input.val();\n    localStorage.setItem(name, val);\n}\n\nexport function showValue(input){\n    let name = input.attr('name');\n    let val = localStorage.getItem(name);\n    input.val(val);\n}\n\nexport function forget(input){\n    let name = input.attr('name');\n    localStorage.removeItem(name);\n    input.val('');\n}\n","export function showSuccessToast(text) {\n    $('.toastSuccess').find('.toast-body').text(text);\n    bootstrap.Toast.getOrCreateInstance($('.toastSuccess')).show();\n}\n\nexport function showFailToast(text) {\n    $('.toastFail').find('.toast-body').text(text);\n    bootstrap.Toast.getOrCreateInstance($('.toastFail')).show();\n}\n\nexport function hideFailToast() {\n    bootstrap.Toast.getOrCreateInstance($('.toastFail')).hide();\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {remember, showValue} from \"../time_logs/index/localStorage\";\n\nrequire('./index/get_excel');\nrequire('./index/payed');\nrequire('./index/generate_bill');\n\n\nwindow.onload = (event) => {\n    $('#billGenerationForm input:not(\"#bill_date\"), #billGenerationForm textarea').each(function () {\n        showValue($(this));\n    })\n\n    $(\"#bill_date\").val(new Date().toJSON().slice(0,10));\n};\n\n$(document).on('change', '#billGenerationForm input, #billGenerationForm textarea', function () {\n    remember($(this));\n})\n"],"names":["handleError","error","infoMessage","console","log","showFailToast","status","statusText","downloadFile","response","file","byteCharacters","atob","byteNumbers","Array","length","i","charCodeAt","byteArray","Uint8Array","blob","Blob","type","mime","link","document","createElement","href","window","URL","createObjectURL","download","filename","body","appendChild","click","removeChild","url","location","$","on","serialize","ajax","method","data","success","xhr","alert","responseText","path","setAttribute","documentOnLoad","each","this","outerHeight","scrollHeight","showValue","val","attr","removeAttr","confirm","closest","find","headers","result","block","replace","replaceWith","showSuccessToast","remember","input","name","localStorage","setItem","getItem","text","bootstrap","Toast","getOrCreateInstance","show","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","require","onload","event","Date","toJSON","slice"],"sourceRoot":""}